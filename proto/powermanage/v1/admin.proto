syntax = "proto3";

package powermanage.v1;

import "powermanage/v1/common.proto";

option go_package = "github.com/manchtools/power-manage/sdk/gen/go/powermanage/v1;powermanagev1";

// AdminService provides administrative operations.
service AdminService {
  // GetLogLevel returns the current log level.
  rpc GetLogLevel(GetLogLevelRequest) returns (GetLogLevelResponse);

  // SetLogLevel changes the server's log level dynamically.
  rpc SetLogLevel(SetLogLevelRequest) returns (SetLogLevelResponse);

  // GetServerInfo returns server information.
  rpc GetServerInfo(GetServerInfoRequest) returns (GetServerInfoResponse);
}

message GetLogLevelRequest {}

message GetLogLevelResponse {
  LogLevel level = 1;
  string level_name = 2;
}

message SetLogLevelRequest {
  // @gotags: validate:"required,oneof=0 1 2 3 4"
  LogLevel level = 1;
}

message SetLogLevelResponse {
  bool success = 1;
  LogLevel previous_level = 2;
  LogLevel new_level = 3;
}

message GetServerInfoRequest {}

message GetServerInfoResponse {
  string version = 1;
  string go_version = 2;
  int64 uptime_seconds = 3;
  int32 active_connections = 4;
  DatabaseInfo database = 5;
}

message DatabaseInfo {
  string path = 1;
  string journal_mode = 2;
  int64 size_bytes = 3;
  int32 migration_version = 4;
}
