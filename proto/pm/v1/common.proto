syntax = "proto3";

package pm.v1;

option go_package = "github.com/manchtools/power-manage/sdk/gen/go/pm/v1;pmv1";

// Unique identifier for an action instance
message ActionId {
  // @gotags: validate:"required,ulid"
  string value = 1;
}

// Unique identifier for a device/agent
message DeviceId {
  // @gotags: validate:"required,ulid"
  string value = 1;
}

// Execution status for any action
enum ExecutionStatus {
  EXECUTION_STATUS_UNSPECIFIED = 0;
  EXECUTION_STATUS_PENDING = 1;
  EXECUTION_STATUS_RUNNING = 2;
  EXECUTION_STATUS_SUCCESS = 3;
  EXECUTION_STATUS_FAILED = 4;
  EXECUTION_STATUS_SKIPPED = 5;
  EXECUTION_STATUS_TIMEOUT = 6;
}

// Desired state for stateful actions
enum DesiredState {
  DESIRED_STATE_PRESENT = 0;  // Install/create/enable
  DESIRED_STATE_ABSENT = 1;   // Remove/delete/disable
}

// Assignment mode determines how an action is applied to a target
enum AssignmentMode {
  ASSIGNMENT_MODE_REQUIRED = 0;  // Mandatory: action will be applied
  ASSIGNMENT_MODE_AVAILABLE = 1; // Optional: user can select
  ASSIGNMENT_MODE_EXCLUDED = 2;  // Blocked: action won't be applied on this target
}

// Structured error detail attached to Connect-RPC errors.
message ErrorDetail {
  // Machine-readable error code (e.g., "user_not_found", "email_already_exists").
  string code = 1;
}

// Compliance status for a device based on detection scripts
enum ComplianceStatus {
  COMPLIANCE_STATUS_UNKNOWN = 0;
  COMPLIANCE_STATUS_COMPLIANT = 1;
  COMPLIANCE_STATUS_NON_COMPLIANT = 2;
  COMPLIANCE_STATUS_IN_GRACE_PERIOD = 3;
}

// Output from command execution
message CommandOutput {
  // @gotags: validate:"omitempty"
  int32 exit_code = 1;
  // @gotags: validate:"omitempty,max=1048576"
  string stdout = 2;
  // @gotags: validate:"omitempty,max=1048576"
  string stderr = 3;
}
